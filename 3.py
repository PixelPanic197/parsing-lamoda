import requests
from bs4 import BeautifulSoup
import pandas as pd
import os

# Список идентификаторов продуктов для парсинга
product_ids = ['mp002xm1uf0o', 'mp002xw0e902', 'mp002xw1crj6', 'mp002xw0o0bc', 'mp002xw0zt38', 'mp002xw1f2v9', 'mp002xw0o0bi', 'mp002xm1uaz6', 'mp002xw0zcjz', 'mp002xw0etkc', 'mp002xw0zh2x', 'mp002xw0q001', 'mp002xm0bpx5', 'mp002xw0ydqp', 'mp002xw0zt3r', 'mp002xw0ekql', 'mp002xw0zh2u', 'mp002xg03b5u', 'mp002xw0o4p7', 'mp002xw0zt3a', 'mp002xw143z3', 'mp002xw0zs0f', 'mp002xm0v9pm', 'mp002xb075q1', 'mp002xb075q0', 'mp002xw0jl2a', 'mp002xw0o0bd', 'mp002xw0zkn4', 'mp002xg049hi', 'mp002xw0zt3n', 'mp002xm0va1a', 'mp002xw0o0bo', 'mp002xw0e911', 'mp002xw17v5m', 'mp002xw1crj1', 'mp002xw18dee', 'mp002xw17v5l', 'mp002xw0o0bb', 'mp002xw1crj8', 'mp002xb05s2n', 'mp002xw175il', 'mp002xw0pzzk', 'mp002xw0o0bk', 'mp002xw1f2u6', 'mp002xw17pb1', 'mp002xw14xyv', 'mp002xw0zt3t', 'mp002xw0zkn1', 'mp002xw1crj9', 'mp002xw1crjj', 'mp002xw17a1r', 'mp002xw0o0bl', 'mp002xw0o0b7', 'mp002xw01dvw', 'mp002xw1crjc', 'mp002xb02a2x', 'mp002xm0bfe2', 'mp002xb02ia7', 'mp002xw0zcjy', 'mp002xw0e8zt', 'mp002xw14xys', 'mp002xm0v90h', 'mp002xb075q1', 'mp002xw0omvr', 'mp002xw0fm4s', 'mp002xw1crj4', 'mp002xw124k1', 'mp002xw175il', 'mp002xw0z14z', 'mp002xm0bfzv', 'mp002xm12g11', 'mp002xw17v5m', 'mp002xw0zt3h', 'mp002xw0o0bk', 'mp002xw0zh2y', 'mp002xw1crj9', 'mp002xm12g10', 'mp002xw0zt34', 'mp002xw15wl7', 'mp002xw0zt3j', 'mp002xw0e911', 'mp002xm0v9pr', 'mp002xw0z15c', 'mp002xm0bfe2', 'mp002xg03gw0', 'mp002xb01xfo', 'mp002xw0o0bl', 'mp002xg0380q', 'mp002xw1f2v0', 'mp002xw0ydqs', 'mp002xm1zd4m', 'mp002xw17pb4', 'mp002xw0zcjy', 'mp002xw0zs0g', 'mp002xw14405', 'mp002xb079bp', 'mp002xw0e90v', 'mp002xw0o0c0', 'mp002xw0ew15', 'mp002xw1f2sx', 'mp002xg03b5v', 'mp002xb05s4h', 'mp002xm008lr', 'mp002xg04aa6', 'mp002xm0brnb', 'mp002xg034ft', 'mp002xm25ar8', 'mp002xm0bmjo', 'mp002xw0zcjx', 'mp002xw0pzzg', 'mp002xb02ia7', 'mp002xw143zv', 'mp002xw0e90n', 'mp002xw0e90k', 'mp002xw16era', 'mp002xm255mg', 'mp002xw0o0bx', 'mp002xm1u9q3', 'mp002xw0zh30', 'mp002xw0e90b', 'mp002xw0ihay', 'mp002xm0bfzv', 'mp002xb075q4', 'mp002xw0zh30', 'mp002xw0wzg3', 'mp002xw0d918', 'mp002xw124k3', 'mp002xb0726l', 'mp002xw143zv', 'mp002xm00k39', 'mp002xb079bt', 'mp002xw1bz7s', 'mp002xw0zt3b', 'mp002xw0pzzg', 'mp002xw0zt3d', 'mp002xm0v90h', 'mp002xm0sc6n', 'mp002xw1g4kt', 'mp002xm25ar8', 'mp002xm0bmjo', 'mp002xm0bmjk', 'mp002xw18ete', 'mp002xm12g11', 'mp002xw0e90k', 'mp002xw0e90v', 'mp002xg03g6b', 'mp002xw0zck0', 'mp002xg04f2x', 'mp002xw14405', 'mp002xw0d919', 'mp002xm1u9q3', 'mp002xw0zcjx', 'mp002xw0e9u9', 'mp002xw0e8zn', 'mp002xm008lr', 'mp002xw0o0bv', 'mp002xw15e98', 'mp002xw16era', 'mp002xw0pzzx', 'mp002xw1f2tf', 'mp002xm1u9p5', 'mp002xw0o0bw', 'mp002xw0zt35', 'mp002xb0726m', 'mp002xg04hl7', 'mp002xw15wl7', 'mp002xm12g10', 'mp002xw143zt', 'mp002xw17paz', 'mp002xw0o0bx', 'mp002xw0ew15', 'mp002xw0wilq', 'mp002xb02i9t', 'mp002xw1g4kx', 'mp002xw0q8uq', 'mp002xw0zt3g', 'mp002xw1f2sr', 'mp002xg04ljb', 'mp002xm0v9pr', 
'mp002xw0zkn6', 'mp002xw0z15z', 'mp002xg04jcj', 'mp002xw0zt3b', 'mp002xm1uf0j', 'mp002xw17pb0', 'mp002xw0e91w', 'mp002xb071to', 'mp002xw1819x', 'mp002xm0vaqq', 'mp002xw0zkn6', 'mp002xw0wilq', 'mp002xg04f2x', 'mp002xm0bmjk', 'mp002xw1f2t0', 'mp002xw1f2ux', 'mp002xw0e90f', 'mp002xw0ydqn', 'mp002xw17paz', 'mp002xw1crjj', 'mp002xm008lx', 'mp002xw0zt3k', 'mp002xw100tq', 'mp002xm008tr', 'mp002xb077kk', 'mp002xw1f2sr', 'mp002xm0vaqm', 'mp002xw1bz7s', 'mp002xw15e98', 'mp002xw0zck0', 'mp002xg03b5s', 'mp002xm1uff6', 'mp002xw0ydqp', 'mp002xw0zt3l', 'mp002xg03kjx', 'mp002xg049hn', 'mp002xm00n1f', 'mp002xw0z168', 'mp002xw18ete', 'mp002xw0zt35', 'mp002xm0b2sf', 'mp002xm1uf0k', 'mp002xw0o0bv', 'mp002xm1u9pn', 'mp002xw0e9u9', 'mp002xb02i9t', 'mp002xg034gf', 'mp002xm0c2js', 'mp002xw1f2th', 'mp002xb071tp', 'mp002xw0yq2l', 'mp002xm0c85s', 'mp002xm1uff9', 'mp002xw1f2t7', 'mp002xw0ekqa', 'mp002xb079bt', 'mp002xm1uf0r', 'mp002xw0wzgi', 'mp002xm1u9qe', 'mp002xw0wslr', 'mp002xg03wgy', 'mp002xg049hm', 'mp002xm008tr', 'mp002xw0zt3p', 'mp002xw0yq2l', 'mp002xg03gv6', 'mp002xm008ti', 'mp002xw1440o', 'mp002xb0726p', 'mp002xw0zt3c', 'mp002xw0yr50', 'mp002xw0jl2b', 'mp002xm0c2js', 'mp002xw0ekqa', 'mp002xw0wzgi', 'mp002xw0zt3k', 'mp002xw1ewi0', 'mp002xm1uaz8', 'mp002xw1f2th', 'mp002xm0bw5j', 'mp002xg03wgu', 'mp002xw0z15t', 'mp002xm1uff6', 'mp002xg048f3', 'mp002xw0zck1', 'mp002xw0e91w', 'mp002xb06x9q', 'mp002xw0zt37', 'mp002xb071tp', 'mp002xw0o4p8', 'mp002xm0c85s', 'mp002xg049hl', 'mp002xw0z168', 'mp002xm0vaqm', 'mp002xm1uf0p', 'mp002xb075q3', 'mp002xw0e91o', 'mp002xm008tl', 'mp002xw148js', 'mp002xw1f2t7', 'mp002xb075q5', 'mp002xg03xgo', 'mp002xg03adc', 'mp002xm1u9qe', 'mp002xm0b3wd', 'mp002xg034gf', 'mp002xw124k2', 'mp002xw0zh31', 'mp002xg0476z', 'mp002xg034gd', 'mp002xw0e904', 'mp002xw17pb5', 'mp002xm0vaqz', 'mp002xw0e90p', 'mp002xg048f4', 'mp002xw0zh2v', 'mp002xm0bfzu', 'mp002xm1uex3', 'mp002xm0vaqq', 'mp002xw18def', 'mp002xw0z15r', 'mp002xw1crja', 'mp002xw01dwl', 'mp002xw0zh2v', 'mp002xw0zck1', 'mp002xw0e90p', 'mp002xw0kvhv', 'mp002xm0c9bl', 'mp002xg03gve', 'mp002xw0ydqr', 'mp002xb02779', 'mp002xb06x9q', 'mp002xb075q3', 'mp002xm008ti', 'mp002xg049hm', 'mp002xm046rw', 'mp002xm008tl', 'mp002xw18def', 'mp002xg03ius', 'mp002xw0e915', 'mp002xg034gd', 'mp002xg03xgp', 'mp002xw1g4ky', 'mp002xw0e91c', 'mp002xm0bfzu', 'mp002xg03wgu', 'mp002xg04770', 'mp002xb01z0s', 'mp002xw0e91r', 'mp002xw17pb5', 'mp002xb0277x', 'mp002xm1zx4a', 'mp002xb06x9r', 'mp002xg049hl', 'mp002xm0bazj', 'mp002xw0ekqs', 'mp002xb077kj', 'mp002xw0e904', 'mp002xw0d917', 'mp002xg0497q', 'mp002xb075q5', 'mp002xg03xgo', 'mp002xg048f4', 'mp002xw1f2uu', 'mp002xw1f2vc', 'mp002xw0e91x', 'mp002xm009ga', 'mp002xw0mk4x', 'mp002xg04f30', 'mp002xb02iae', 'mp002xw0yq2m', 'mp002xg0476z', 'mp002xm1uazc', 'mp002xw1g4ku', 'mp002xg03adc', 'mp002xg049hj', 'mp002xb0726p', 'mp002xw0lfct', 'mp002xm0bj3l', 'mp002xm1u9q7', 'mp002xg03wgj', 'mp002xm0bazi', 'mp002xw1f2t8', 'mp002xw0wslm', 'mp002xm0bfzs', 'mp002xw1gfho', 'mp002xg03iuh', 'mp002xm0bzs0', 'mp002xb0277c', 'mp002xw1f2uo', 'mp002xw0z15n', 
'mp002xw0o0bj', 'mp002xw0o0bn', 'mp002xb01z1o', 'mp002xw0o0by', 'mp002xw1f2u4', 'mp002xw0pzzr', 'mp002xg041vx', 'mp002xb06yfd', 'mp002xb02izs', 'mp002xg04hl8', 'mp002xm0swru', 'mp002xg04hl1', 'mp002xm1uex4', 'mp002xg04jci', 'mp002xg041vq', 'mp002xg03gvz', 'mp002xw004r1', 'mp002xb029bq', 'mp002xg04f31', 'mp002xm046rq', 'mp002xb02ia2', 'mp002xm1uf0l', 'mp002xw0yrel', 'mp002xw0z4ny', 'mp002xw0e90a', 'mp002xg045h7', 'mp002xm009gd', 'mp002xg04a3r', 'mp002xw0d916', 'mp002xm0b2si', 'mp002xm008tq', 'mp002xm046t6', 'mp002xw0zus2', 'mp002xw1crj5', 'mp002xw0e903', 'mp002xw0zkn7', 'mp002xg03bwu', 'mp002xm0bdol', 'mp002xw1bz7v', 'mp002xm00k3d', 'mp002xw1crjf', 'mp002xw1f2tm', 'mp002xw0odrp', 'mp002xm0b2sg', 'mp002xw1440j', 'mp002xw0wzfx', 'mp002xw0pzzf', 'mp002xw0fm4j', 'mp002xw0dars', 'mp002xm00k38', 'mp002xm1u9s5', 'mp002xm161f0', 'mp002xw0o0bu', 'mp002xw1f2uh', 'mp002xw0q000', 'mp002xw19wh0', 'mp002xg04hl6', 'mp002xb05s3l', 'mp002xb0292k', 'mp002xw0ihaz', 'mp002xm00fcm', 'mp002xw1crje', 'mp002xg03wgf', 'mp002xw143yf', 'mp002xw0o4pa', 'mp002xg04a3q', 'mp002xm12g13', 'mp002xw0jucq', 'mp002xw18etg', 'mp002xw18mqc', 'mp002xw0o4p6', 'mp002xw1crjg', 'mp002xm0va1b', 'mp002xw0wsir', 'mp002xm0byic', 'mp002xw0o4p5', 'mp002xw1crjb', 'mp002xw1crjh', 'mp002xw1f2tk', 'mp002xw0f3uc', 'mp002xw0mr5p', 'mp002xw0ipdc', 'mp002xw0xf1q', 'mp002xm009gb', 'mp002xb0726n', 'mp002xw0e8m4', 'mp002xm008tm', 'mp002xw0xf0p', 'mp002xm1uf0x', 'mp002xg048f2', 'mp002xm1zvc0', 'mp002xm0v9pj', 'mp002xm0vaqn', 'mp002xm046rt', 'mp002xw0zt3u', 'mp002xw0e907', 'mp002xw18mqk', 'mp002xm0bs2q', 'mp002xw0o4p4', 'mp002xw0o0be', 'mp002xw1440a', 'mp002xb027md', 'mp002xg03g67', 'mp002xw0zt3q', 'mp002xw0o0bf', 'mp002xw1819k', 'mp002xm0bfzw', 'mp002xm0v90f', 'mp002xw0wzfh', 'mp002xw1f2t3', 'mp002xb02a2v', 'mp002xg045hb', 'mp002xw0pzzh', 'mp002xw0q34k', 'mp002xm12jri', 'mp002xw0o0bz', 'mp002xw0e8zu', 'mp002xb0786g', 'mp002xb026lu', 'mp002xw004iw', 'mp002xw124k0', 'mp002xg04hl5', 'mp002xg04f2w', 'mp002xw0o0c1', 'mp002xm12g0u', 'mp002xb02a2u', 'mp002xg03xgs', 'mp002xb078ow', 'mp002xw0ij9q', 'mp002xw18etf', 'mp002xg03aq3', 'mp002xb02i9l', 'mp002xw0wzgk', 'mp002xb02i9j', 'mp002xw0e919', 'mp002xg044qi', 'mp002xm0b0iu', 'mp002xw0yq1z', 'mp002xg04jcg', 'mp002xg03ix0', 'mp002xb023cz', 'mp002xw0q8u4', 'mp002xm0vaqu', 'mp002xb0786l', 'mp002xw0zt39', 'mp002xm0bw5i', 'mp002xw1f2tb', 'mp002xw0wslk', 'mp002xw0jer1', 'mp002xw0zt3i', 'mp002xw0ekq9', 'mp002xw0mk50', 'mp002xw0ekqc', 'mp002xg0430x', 'mp002xg04jch', 'mp002xb06zmd', 'mp002xg045he', 'mp002xb022mo', 'mp002xw0e90w', 'mp002xw1440g', 'mp002xw0z15o', 'mp002xg03kjs', 'mp002xb0710q', 'mp002xg04hl4', 'mp002xg04jcf', 'mp002xm0vaqo', 'mp002xb02izv', 'mp002xb02ia3', 'mp002xw0o0bm', 'mp002xw0zt36', 'mp002xm00fcc', 'mp002xg03hg7', 'mp002xw0ekqj', 'mp002xg03hfx', 'mp002xm0bst8', 'mp002xw0ydqq', 'mp002xb077ki', 'mp002xw008yq', 'mp002xw0wsll', 'mp002xm046t0', 'mp002xw0wslw', 'mp002xb02izn', 'mp002xm00fcb', 'mp002xm00fce', 'mp002xb0710s', 'mp002xw0e8m2', 'mp002xw0z15m', 'mp002xm0b2sh', 'mp002xm0bst7', 'mp002xm08u7n', 'mp002xg03aq9', 
'mp002xw1f2u2', 'mp002xg04a3v', 'mp002xb02ia9', 'mp002xb02jb1', 'mp002xw1f2va', 'mp002xw0pyv3', 'mp002xm1u9p8', 'mp002xm0bfzt', 'mp002xw0wslx', 'mp002xw0jlj4', 'mp002xw0yq2o', 'mp002xw0q8uc', 'mp002xw0odrn', 'mp002xw1f2te', 'mp002xw1f2uv', 'mp002xw0f3vg', 'mp002xm00fcl', 'mp002xb0786i', 'mp002xg03gv3', 'mp002xw0z4ks', 'mp002xw0e8zm', 'mp002xg03dsm', 'mp002xw1f2us', 'mp002xw0ws4v', 'mp002xw0oa7u', 'mp002xw0yq2n', 'mp002xw0zurz', 'mp002xm00fc9', 'mp002xw0ekqi', 'mp002xw0e917', 'mp002xb0726o', 'mp002xw18deg', 'mp002xm0v9pi', 'mp002xw0q8ud', 'mp002xm00iy6', 'mp002xw0e90o', 'mp002xw00pt8', 'mp002xw1f2uq', 'mp002xm0v9pk', 'mp002xw01lyi', 'mp002xg04a3n', 'mp002xw1f2tz', 'mp002xg03dsn', 'mp002xb079br', 'mp002xb026lv', 'mp002xm0b3wc', 'mp002xm0bfzq', 'mp002xb02jsi', 'mp002xm08u7q', 'mp002xm08u7i', 'mp002xg04hl2', 'mp002xm1uex1', 'mp002xw1440p', 'mp002xw1f2up', 'mp002xm009gc', 'mp002xw0etko', 'mp002xb02izr', 'mp002xb0786k', 'mp002xw0q8tr', 'mp002xw0z15p', 'mp002xm00fc2', 'mp002xw19whd', 'mp002xm1u9pq', 'mp002xw1f2uf', 'mp002xg04ikq', 'mp002xg046i3', 'mp002xw0yr4v', 'mp002xw0yq2r', 'mp002xw0z166', 'mp002xw0q8uk', 'mp002xw0ipdh', 'mp002xw0z162', 'mp002xw0z15w', 'mp002xw0e910', 'mp002xw0oaby', 'mp002xg041w1', 'mp002xw0e913', 'mp002xw1f2t9', 'mp002xw0daqr', 'mp002xb02ia0', 'mp002xw0z4ob', 'mp002xw18mqb', 'mp002xw0pzzi', 'mp002xg04hl3', 'mp002xw0e91p', 'mp002xw1f2ug', 'mp002xw0jlg9', 'mp002xb0786j', 'mp002xw0z15k', 'mp002xw0pzzm', 'mp002xw00tth', 'mp002xw0e91b', 'mp002xg03wgs', 'mp002xw0z15e', 'mp002xb02izp', 'mp002xg04iky', 'mp002xw0wslz', 'mp002xm0c2jp', 'mp002xg04ikw', 'mp002xb0277k', 'mp002xw0jlj7', 'mp002xb02i9x', 'mp002xg041vs', 'mp002xw14q2f', 'mp002xw0z4oi', 'mp002xw0jlec', 'mp002xw0f3ub', 'mp002xg04f32', 'mp002xm0c9bk', 'mp002xw1f2tc', 'mp002xw13194', 'mp002xb06xgf', 'mp002xw0q8u9', 'mp002xw0e91n', 'mp002xb02i9o', 'mp002xw0o0c3', 'mp002xm000v1', 'mp002xb071lp', 'mp002xb06zm9', 'mp002xw0e91t', 'mp002xw0e90x', 'mp002xm0c9bh', 'mp002xg041vv', 'mp002xm1uaz5', 'mp002xw143zr', 'mp002xg03bdi', 'mp002xw0ipda', 'mp002xb05s2y', 'mp002xb02izq', 'mp002xw0q8tw', 'mp002xw15wl5', 'mp002xw1crj2', 'mp002xw010ig', 'mp002xw0wsl5', 'mp002xm1u9qr', 'mp002xw172m6', 'mp002xg03xgr', 'mp002xw0tggj', 'mp002xm08u7j', 'mp002xw0e91d', 'mp002xb05s1u', 'mp002xw1ggtg', 'mp002xw0iuse', 'mp002xw0q8u0', 'mp002xw0mm0u', 'mp002xg03ad9', 'mp002xb05s1b', 'mp002xw19wh6', 'mp002xg044qh', 'mp002xw0wsjq', 'mp002xg045hd', 'mp002xw0oa80', 'mp002xg043au', 'mp002xw1f2ua', 'mp002xg0430t', 'mp002xw0f3vb', 'mp002xb02i9m', 'mp002xm0c85u', 'mp002xb06xgg', 'mp002xg03bx5', 'mp002xg03ada', 'mp002xm0bgr3', 'mp002xm0byid', 'mp002xw0e91q', 'mp002xw0jl25', 'mp002xg04a3u', 'mp002xw1f2t6', 'mp002xb0277o', 'mp002xw0e8ma', 'mp002xw1f2tt', 'mp002xw0pyv4', 'mp002xw0flwb', 'mp002xb05s2g', 'mp002xb079bs', 'mp002xw0zkn2', 'mp002xw0emwl', 'mp002xw0wsiq', 'mp002xw0f3ud', 'mp002xw1gfhm', 'mp002xw0o0bh', 'mp002xw0z15v', 'mp002xw1f2tl', 'mp002xw143yd', 'mp002xw0x0an', 'mp002xw0tjlx', 'mp002xw0q8uh', 'mp002xw0wsis', 'mp002xg0494i', 'mp002xw0e8m8', 'mp002xb05s37', 'mp002xm0bst9', 
'mp002xg04771', 'mp002xb05s2p', 'mp002xw0oa7w', 'mp002xb02i9q', 'mp002xw0wzg0', 'mp002xg04a3p', 'mp002xg037ft', 'mp002xb02izt', 'mp002xm0swrh', 'mp002xw1f2ui', 'mp002xb02ia5', 'mp002xg03wgm', 'mp002xb05s54', 'mp002xg02z20', 'mp002xg03hg2', 'mp002xm0bfzr', 'mp002xw0oaco', 'mp002xm00n1l', 'mp002xm24q86', 'mp002xg03210', 'mp002xg044qk', 'mp002xg04a3s', 'mp002xm0bpx7', 'mp002xb05s1l', 'mp002xw0jlfi', 'mp002xb05s3j', 'mp002xw16eqr', 'mp002xg0430v', 'mp002xb05s3y', 'mp002xm00hlm', 'mp002xg0476y', 'mp002xg043ax', 'mp002xg04a3o', 'mp002xm0bdom', 'mp002xg043aw', 'mp002xg03ix1', 'mp002xg043b0', 'mp002xg041w0', 'mp002xg0430w', 'mp002xg041vz', 'mp002xw00wti', 'mp002xw1f2tw', 'mp002xm00n1j', 'mp002xg043ay', 'mp002xw0xf1j', 'mp002xm0bst5', 'mp002xg02yor', 'mp002xg04a3m', 'mp002xg02rj2', 'mp002xm00k34', 'mp002xw0q8tq', 'mp002xw00wtg', 'mp002xm0v82e', 'mp002xm0bgri', 'mp002xm0brna', 'mp002xg0476x', 'mp002xw01lxp', 'mp002xm0bmjj', 'mp002xm0bsta', 'mp002xw008yh', 'mp002xw0z4ov', 'mp002xg03wgk', 'mp002xm00hlr', 'mp002xw0wzg1', 'mp002xw1g1a0', 'mp002xm008lv', 'mp002xm0bst6', 'mp002xm0v9pl', 'mp002xw1f2v2', 'mp002xw0iusg', 'mp002xg043av', 'mp002xm08u7m', 'mp002xw0e91a', 'mp002xm0c85t', 'mp002xw0oacu', 'mp002xb06yxv', 'mp002xb02a2s', 'mp002xm0brn9', 'mp002xm046t9', 'mp002xm0bazk', 'mp002xw0jlj6', 'mp002xw0pyv5', 'mp002xw19wgy', 'mp002xw1f2u9', 'mp002xg03dn3', 'mp002xb071tn', 'mp002xw100tx', 'mp002xg03bmx', 'mp002xw0q002', 'mp002xg03l97', 'mp002xw1gfhq', 'mp002xm0c2jr', 'mp002xg041vw', 'mp002xm00hlq', 'mp002xm0byif', 'mp002xg041vr', 'mp002xw0ekqp', 'mp002xg02j17', 'mp002xg0430s', 'mp002xw0iwa8', 'mp002xm0bmjn', 'mp002xg03acq', 'mp002xw01cx4', 'mp002xw0zt3f', 'mp002xg02z29', 'mp002xm1zw3t', 'mp002xw0zury', 'mp002xm0bzpb', 'mp002xg04a3t', 'mp002xg03564', 'mp002xm1zvbw', 'mp002xm0bpx6', 'mp002xg0430m', 'mp002xm0bmjm', 'mp002xb05rzg', 'mp002xb05rzb', 'mp002xg02yp2', 'mp002xb02b05', 'mp002xb06yfe', 'mp002xg03j53', 'mp002xg03992', 'mp002xb02b0d', 'mp002xb01y5v', 'mp002xm0n0im', 'mp002xw0oac0', 'mp002xm00fco', 'mp002xg02j1c', 'mp002xm1zvbo', 'mp002xm00fc5', 'mp002xg0398z', 'mp002xm0t0o1', 'mp002xm253nx', 'mp002xw0wzge', 'mp002xg03aco', 'mp002xg03ajf', 'mp002xw0jlga', 'mp002xg03567', 'mp002xw0z160', 'mp002xg038j9', 'mp002xg02j1e', 'mp002xw175ik', 'mp002xw0jh5t', 'mp002xg03xgu', 'mp002xg04aa7', 'mp002xg049hk', 'mp002xg03ad1', 'mp002xm0bmjl', 'mp002xw0jjpw', 'mp002xw0yq2f', 'mp002xg03acx', 'mp002xw1c1zd', 'mp002xm0b9wh', 'mp002xg03acy', 'mp002xw100u0', 'mp002xw0ekqo', 'mp002xg03ad0', 'mp002xw0iusf', 'mp002xw0xf1n', 'mp002xw100tt', 'mp002xw0ipdo', 'mp002xm00n1i', 'mp002xm009g5', 'mp002xw008ym', 'mp002xw0ij9p', 'mp002xb02640', 'mp002xm0bv6f', 'mp002xm00fcn', 'mp002xw0z4kv', 'mp002xm0bv6g', 'mp002xm1u9qd', 'mp002xb023no', 'mp002xm0bb31', 'mp002xb06xgh', 'mp002xw1f2vk', 'mp002xb05s30', 'mp002xm0bv6e', 'mp002xm0byie', 'mp002xb021wl', 'mp002xb01va7', 'mp002xm0v7xj', 'mp002xw0q8tm', 'mp002xb01vgz', 'mp002xw0f3uk', 'mp002xg046i2', 'mp002xw01dws', 'mp002xw1a0fy', 'mp002xw19wh3', 'mp002xm0sc74', 'mp002xb06yxs', 'mp002xb06xyi', 'mp002xm14y1y', 
'mp002xm09nha', 'mp002xw1bz7t', 'mp002xw0e8m6', 'mp002xw0wslj', 'mp002xw00qom', 'mp002xw0z4o6', 'mp002xm14y22', 'mp002xm0vaqr', 'mp002xm0sc6w', 'mp002xm0sc6t', 'mp002xm14y23', 'mp002xm046vq', 'mp002xw0lfcw', 'mp002xm14y1t', 'mp002xm0n0iw', 'mp002xw1cg3e', 'mp002xw0z159', 'mp002xw0kvhk', 'mp002xw0flvy', 'mp002xw01dwg', 'mp002xw1f2uk', 'mp002xw1g4l0', 'mp002xm00n1g', 'mp002xw0q8tz', 'mp002xw00tsw', 'mp002xw1f2tp', 'mp002xm1zd52', 'mp002xm0sc72', 'mp002xm00n1e', 'mp002xw0yq2g', 'mp002xm00n1k', 'mp002xm0t0o2', 'mp002xm08kli', 'mp002xm0b9we', 'mp002xw1a517', 'mp002xw0z167', 'mp002xm0t0nv', 'mp002xw0z4kx', 'mp002xw0xf15', 'mp002xm0b9wg', 'mp002xm00fca', 'mp002xw1440s', 'mp002xw01ly7', 'mp002xw0wsjd', 'mp002xm0t0nm', 'mp002xm08i2r', 'mp002xm1zvci', 'mp002xw0xf0f', 'mp002xm1uaz4', 'mp002xm0swri', 'mp002xm1zx47', 'mp002xw19ldv', 'mp002xw18mqf', 'mp002xm0vaql', 'mp002xw18mqh', 'mp002xm000uz', 'mp002xm0n0iv', 'mp002xm000yb', 'mp002xw15wfw', 'mp002xw0xf0w', 'mp002xw1f2tj', 'mp002xw0ekqk', 'mp002xm0t0nn', 'mp002xm046td', 'mp002xw0e3v4', 'mp002xw0wzg2', 'mp002xm1zd4b', 'mp002xw0fna7', 'mp002xm0b3wl', 'mp002xw100tz', 'mp002xm0swrp', 'mp002xw0z4oo', 'mp002xw0zt3m', 'mp002xm0sc6v', 'mp002xm12dga', 'mp002xw1f2t5', 'mp002xm12dg7', 'mp002xm0t0o0', 'mp002xm0swrs', 'mp002xm0sc6r', 'mp002xm0n0iu', 'mp002xm0sc6l', 'mp002xm14y1w', 'mp002xm1zd4j', 'mp002xm046tg', 'mp002xm1zd4c', 'mp002xm0v75r', 'mp002xm0sc7b', 'mp002xm12dg5', 'mp002xm0swrm', 'mp002xm1zd48', 'mp002xm0sc7f', 'mp002xm0sc6x', 'mp002xm0v76n', 'mp002xm1zw3l', 'mp002xm0swrq', 'mp002xm24q66', 'mp002xm1zx53', 'mp002xw0q8tl', 'mp002xw0pzzu', 'mp002xw0ipdp', 'mp002xw0e8zf', 'mp002xw0fm4b', 'mp002xw0e8zp', 'mp002xw0o0b8', 'mp002xw14xyq', 'mp002xw016s8', 'mp002xw0z15q', 'mp002xw008yl', 'mp002xw0z14v', 'mp002xw0jl1z', 'mp002xw15wfy', 'mp002xw0ipdf', 'mp002xw19wgx', 'mp002xw0ekqv', 'mp002xw1crj3', 'mp002xw1f2tg', 'mp002xw0th1e', 'mp002xw19wh8', 'mp002xw1a0fs', 'mp002xw0wzfp', 'mp002xw0z161', 'mp002xw0ipdd', 'mp002xw1cjos', 'mp002xw008yi', 'mp002xw0jl23', 'mp002xw0ipdn', 'mp002xw1cjqh', 'mp002xw0e900', 'mp002xw0oadd', 'mp002xw0iuso', 'mp002xw0wzgf', 'mp002xw0ipdj', 'mp002xw0iq9p', 'mp002xw1c25v', 'mp002xw175im', 'mp002xw0wzgg', 'mp002xw0xf0e', 'mp002xw0oacs', 'mp002xw0wslg', 'mp002xw008yp', 'mp002xw100tu', 'mp002xw0wsju', 'mp002xw0fm4d', 'mp002xw01dvx', 'mp002xw175in', 'mp002xw0e91h', 'mp002xw0dcb5', 'mp002xw0m6x9', 'mp002xw0wzg9', 'mp002xw0ekqh', 'mp002xw0zt3o', 'mp002xw0iur9', 'mp002xw016up', 'mp002xw0wsly', 'mp002xw1cjol', 'mp002xw0dcb4', 'mp002xw13198', 'mp002xw0z4oj', 'mp002xw1g1a5', 'mp002xw0ge2v', 'mp002xw0iusz', 'mp002xw1a0fn', 'mp002xw0jlg6', 'mp002xw0ipdm', 'mp002xw100tr', 'mp002xw19wh1', 'mp002xw0wslq', 'mp002xw1c25s', 'mp002xw1f2tx', 'mp002xw100tv', 'mp002xw1440q', 'mp002xw1f2ta', 'mp002xw1f2u0', 'mp002xw19wgz', 'mp002xw0iusu', 'mp002xw0wslt', 'mp002xw1c25r', 'mp002xw0odrw', 'mp002xw00t9b', 'mp002xw01dw6', 'mp002xw0dcb7', 'mp002xw100ts', 'mp002xw0flw5', 'mp002xw148jr', 'mp002xw100tp', 'mp002xw016si', 'mp002xw0flw6', 'mp002xw01lpa', 'mp002xw0wsk6', 'mp002xw00xck', 
'mp002xw0jlf0', 'mp002xw1f2su', 'mp002xw1c1zc', 'mp002xw0jlf7', 'mp002xw0qb14', 'mp002xw0jlf5', 'mp002xw0wzgd', 'mp002xw0q34n', 'mp002xw0z4p6', 'mp002xw016ui', 'mp002xw0rnu4', 'mp002xw01dvi', 'mp002xw148jq', 'mp002xw165yw', 'mp002xw0fm4u', 'mp002xw0wskb', 'mp002xw0q34m', 'mp002xw0mkna', 'mp002xw0iwa4', 'mp002xw0zub5', 'mp002xw1gfhn', 'mp002xw0jlex', 'mp002xw0kmo4', 'mp002xw1a0fu', 'mp002xw0oacx', 'mp002xw1c25u', 'mp002xw0rnua', 'mp002xw0flau', 'mp002xw008yo', 'mp002xw0z15h', 'mp002xw008yn', 'mp002xw0iwa9', 'mp002xw15wfz', 'mp002xw008yk', 'mp002xw0iwa5', 'mp002xw1a0fx', 'mp002xw0n35p', 'mp002xw0etka', 'mp002xw0mknk', 'mp002xw0zub6', 'mp002xw0wske', 'mp002xw0ekqw', 'mp002xw15vwy', 'mp002xw0wskv', 'mp002xw0daqd', 'mp002xw0flan', 'mp002xw01dvt', 'mp002xw00tvp', 'mp002xw0n35o', 'mp002xw00wus', 'mp002xw0mkpc', 'mp002xw0jy7m', 'mp002xw0mknp', 'mp002xw0oad8', 'mp002xw15vx4', 'mp002xw00tt6', 'mp002xw1g1a4', 'mp002xw0rnu0', 'mp002xw0ff6i', 'mp002xw01dvf', 'mp002xw0oad0', 'mp002xw1f2u8', 'mp002xw0dcb6', 'mp002xw01dvb', 'mp002xw0odrr', 'mp002xw0iur1', 'mp002xw0mkne', 'mp002xw0xf0l', 'mp002xw15vyp', 'mp002xw0f3uh', 'mp002xw0mkno', 'mp002xw0e91f', 'mp002xw1a0p8', 'mp002xw0e908', 'mp002xw1a0ft', 'mp002xw016w0', 'mp002xw1g19y', 'mp002xw0xf0q', 'mp002xw0jlff', 'mp002xw0obrb', 'mp002xw0mknj', 'mp002xw0mknf', 'mp002xw0ekqr', 'mp002xw0oacy', 'mp002xw1a0fp', 'mp002xw0jlf4', 'mp002xw0etkf', 'mp002xw100ty', 'mp002xw00tsq', 'mp002xw00tsz', 'mp002xw0m9ju', 'mp002xw19ldu', 'mp002xw19ldx', 'mp002xw00wul', 'mp002xw0ius4', 'mp002xw0fm4e', 'mp002xw0mgs4', 'mp002xw0rnu3', 'mp002xw1ghlx', 'mp002xw1ghly', 'mp002xw0mgs9', 'mp002xw1ghm4', 'mp002xw1g1a7', 'mp002xw00ts5', 'mp002xw0zub4', 'mp002xw0l3fi', 'mp002xw00xcq', 'mp002xw0fm4p', 'mp002xw0m9jo', 'mp002xw0zcjv', 'mp002xw18mqd', 'mp002xw18mqj', 'mp002xw14xyu', 'mp002xb0232m', 'mp002xw0192c', 'mp002xw1f2un', 'mp002xb024r8', 'mp002xw14q5j', 'mp002xw0iurr', 'mp002xm008ls', 'mp002xw0q34l', 'mp002xw0fm4l', 'mp002xm00fcg', 'mp002xg03u3a', 'mp002xw0flw7']
   # Замените на нужные артикулы

# Подготовим список для хранения данных
data = []

# Цикл по каждому идентификатору товара
for product_id in product_ids:
    url = f"https://www.lamoda.ru/p/{product_id}/"
    
    # Создание сессии requests для сохранения состояния между запросами
    with requests.Session() as session:
        session.max_redirects = 5  # Ограничение на количество редиректов
        response = session.get(url, allow_redirects=True)

    # Проверяем доступность страницы
    if response.status_code != 200:
        print(f"Не удалось получить данные для продукта с ID {product_id}")
        continue

    # Считываем страницу после редиректа
    soup = BeautifulSoup(response.text, 'html.parser')

    # Извлечение данных с проверками
    try:
        # Цена со скидкой
        price_with_discount = soup.select_one('span._price_1u4o8_11[aria-label="Итоговая цена"]').text.strip() if soup.select_one('span._price_1u4o8_11[aria-label="Итоговая цена"]') else "N/A"

        # Цена без скидки
        price_without_discount = soup.select_one('span._price_1u4o8_11[aria-label=""]').text.strip() if soup.select_one('span._price_1u4o8_11[aria-label=""]') else "N/A"

        # Артикул
        article_code = soup.select_one('span._value_ajirn_27.ui-product-description-attribute-sku').text.strip() if soup.select_one('span._value_ajirn_27.ui-product-description-attribute-sku') else "N/A"

        # Добавляем данные в список
        data.append({
            'Артикул': article_code,
            'Цена со скидкой': price_with_discount,
            'Цена без скидки': price_without_discount
        })

        print(f"Получены данные для продукта с ID {product_id}: Артикул: {article_code}, Цена со скидкой: {price_with_discount}, Цена без скидки: {price_without_discount}")

    except Exception as e:
        print(f"Ошибка при парсинге продукта с ID {product_id}: {e}")
        continue

# Проверяем, существует ли файл Excel
file_path = 'lamoda_product_data.xlsx'
if os.path.exists(file_path):
    # Загружаем существующие данные
    df_existing = pd.read_excel(file_path)
    df_new = pd.DataFrame(data)
    # Добавляем новые данные в существующий файл
    df = pd.concat([df_existing, df_new], ignore_index=True)
else:
    # Создаем новый файл, если его нет
    df = pd.DataFrame(data)

# Сохраняем в Excel
df.to_excel(file_path, index=False)

print(f"Данные сохранены в файл '{file_path}'")
